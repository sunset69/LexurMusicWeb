{"version":3,"sources":["webpack://cplayer-umd/webpack/universalModuleDefinition","webpack://cplayer-umd/webpack/bootstrap","webpack://cplayer-umd/./src/lib/playmode/listloop.ts","webpack://cplayer-umd/(webpack)/buildin/global.js","webpack://cplayer-umd/./src/lib/index.ts","webpack://cplayer-umd/./node_modules/timers-browserify/main.js","webpack://cplayer-umd/./node_modules/setimmediate/setImmediate.js","webpack://cplayer-umd/./node_modules/process/browser.js","webpack://cplayer-umd/./src/lib/polyfill.js","webpack://cplayer-umd/./src/lib/helper/shallowEqual.ts","webpack://cplayer-umd/./node_modules/events/events.js","webpack://cplayer-umd/./src/lib/lyric.ts","webpack://cplayer-umd/./src/lib/playmode/singlecycle.ts","webpack://cplayer-umd/./src/lib/playmode/listrandom.ts","webpack://cplayer-umd/./src/lib/mediaSession.ts","webpack://cplayer-umd/./src/defaultposter.jpg"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","baseRemoveMusic","item","playlist","nowpoint","newpoint","targetPoint","needupdate","forEach","a","index","splice","listloopPlaymode","point","__playlist","this","to","nextPoint","prevPoint","Math","max","min","length","push","res","g","Function","e","defaultOption","volume","playmode","autoplay","playmodes","listloop","singlecycle","singlecyclePlaymode","listrandom","listrandomPlaymode","playlistPreFilter","map","audio","lyric","replace","trim","decodeLyricStr","sublyric","cplayer","options","__paused","playmodeName","_volume","eventHandlers","handlePlay","pause","handlePlaying","audioElement","currentTime","emit","handleTimeUpdate","time","duration","playedTime","handleCanPlayThrough","args","handlePause","ended","play","catch","console","log","handleEnded","next","handlePlayListChange","handlePlaymodeChange","handleLoadeddata","cplayerMediaSessionPlugin","setImmediate","openAudio","setVolume","element","addEventListener","removeEventListener","percentage","parseFloat","toString","paused","readyState","nowplay","type","audioElementType","removeEventEmitter","src","document","createElement","HTMLVideoElement","loop","poster","setAttribute","initializeEventEmitter","Audio","setMode","nowplaypoint","Forced","isPlaying","id","prev","addMusic","needUpdate","removeMusic","removeAllListeners","view","destroy","getOwnPropertyNames","__proto__","now","EventEmitter","self","apply","Timeout","clearFn","_id","_clearFn","setTimeout","scope","arguments","clearTimeout","setInterval","clearInterval","timeout","close","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","global","clearImmediate","registerImmediate","html","channel","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","getPrototypeOf","process","handle","nextTick","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","event","data","port2","documentElement","script","onreadystatechange","removeChild","appendChild","random","source","indexOf","slice","attachEvent","callback","Array","task","run","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","len","marker","runClearTimeout","Item","array","noop","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","assign","target","varArgs","TypeError","nextSource","nextKey","writable","configurable","hasOwn","is","x","y","objA","objB","keysA","keys","keysB","ReflectOwnKeys","R","Reflect","ReflectApply","receiver","ownKeys","getOwnPropertySymbols","NumberIsNaN","Number","isNaN","init","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","_getMaxListeners","that","_addListener","prepend","events","existing","warning","newListener","unshift","warned","w","String","emitter","count","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","unwrapListeners","arrayClone","listenerCount","copy","set","arg","RangeError","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","list","position","originalListener","shift","pop","spliceOne","rawListeners","eventNames","Lyric","items","raw","reduce","decodeLyricStrItem","lyricItemStr","timestr","match","word","exec","z","parseInt","lyricStr","split","lyricStrItem","randomPoint","floor","defaultPoster","mediaMetadata","MediaMetadata","artist","album","artwork","sizes","player","navigator","mediaSession","metadata","setActionHandler"],"mappings":"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","file":"cplayer-noview.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cplayer-umd\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cplayer-umd\"] = factory();\n\telse\n\t\troot[\"cplayer-umd\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","import { IAudioItem, Iplaymode, Iplaylist } from '../interfaces';\r\nimport shallowEqual from \"../helper/shallowEqual\";\r\n\r\nexport function baseRemoveMusic(item: IAudioItem, playlist: Iplaylist, nowpoint: number, newpoint: (point: number) => number) {\r\n  let targetPoint: number;\r\n  let needupdate = false;\r\n  playlist.forEach((a, index) => {\r\n    if (shallowEqual(a, item)) {\r\n      targetPoint = index;\r\n    }\r\n  })\r\n  if (typeof targetPoint !== 'undefined') {\r\n    playlist.splice(targetPoint, 1);\r\n    if (nowpoint > targetPoint) {\r\n      nowpoint--;\r\n      needupdate = false;\r\n    } else if (nowpoint === targetPoint) {\r\n      nowpoint = newpoint(nowpoint);\r\n      needupdate = true;\r\n    }\r\n  }\r\n  return { playlist, nowpoint, needupdate };\r\n}\r\n\r\nexport class listloopPlaymode implements Iplaymode {\r\n  private __playlist: Iplaylist = [];\r\n  private point = 0;\r\n  get playlist() {\r\n    return this.__playlist;\r\n  }\r\n\r\n  constructor(playlist: Iplaylist = [], point: number = 0) {\r\n    this.__playlist = playlist;\r\n    this.to(point);\r\n  }\r\n\r\n  public next() {\r\n    this.point = this.nextPoint();\r\n    return this.playlist[this.point];\r\n  }\r\n\r\n  public prev() {\r\n    this.point = this.prevPoint();\r\n    return this.playlist[this.point];\r\n  }\r\n\r\n  public now() {\r\n    return this.playlist[this.point];\r\n  }\r\n\r\n  public nowpoint() {\r\n    return this.point\r\n  }\r\n\r\n  public to(point: number) {\r\n    this.point = Math.max(0, Math.min(point, this.__playlist.length - 1));\r\n  }\r\n\r\n  public addMusic(item: IAudioItem) {\r\n    this.__playlist.push(item);\r\n  }\r\n\r\n  private nextPoint() {\r\n    let res = this.point + 1;\r\n    if (res >= this.__playlist.length) {\r\n      res = 0;\r\n    }\r\n    return res;\r\n  }\r\n\r\n  private prevPoint() {\r\n    let res = this.point - 1;\r\n    if (res < 0) {\r\n      res = this.__playlist.length - 1\r\n    }\r\n    return res;\r\n  }\r\n\r\n  public removeMusic(item: IAudioItem) {\r\n    let { playlist, nowpoint, needupdate } = baseRemoveMusic(item, this.__playlist, this.point, (point) => Math.max(0, Math.min(point, this.__playlist.length - 1)))\r\n    this.__playlist = playlist;\r\n    this.point = nowpoint;\r\n    return needupdate;\r\n  }\r\n}","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","require('./polyfill')\r\nimport { listloopPlaymode } from './playmode/listloop';\r\nimport { IAudioItem, Iplaymode, IplaymodeConstructor, Iplaylist } from './interfaces';\r\nimport { EventEmitter } from 'events';\r\nimport View, { ICplayerViewOption } from './view';\r\nimport { decodeLyricStr } from \"./lyric\";\r\nimport { singlecyclePlaymode } from \"./playmode/singlecycle\";\r\nimport { listrandomPlaymode } from \"./playmode/listrandom\";\r\nimport shallowEqual from \"./helper/shallowEqual\";\r\nimport { cplayerMediaSessionPlugin } from \"./mediaSession\";\r\n\r\nlet cplayerView:typeof View = undefined;\r\n\r\nif (!process.env.cplayer_noview) {\r\n  cplayerView = require('./view').default;\r\n}\r\n\r\nexport interface ICplayerOption {\r\n  playlist?: Iplaylist;\r\n  playmode?: string;\r\n  volume?: number;\r\n  point?: number;\r\n  autoplay?: boolean;\r\n}\r\n\r\nconst defaultOption: ICplayerOption = {\r\n  playlist: [],\r\n  point: 0,\r\n  volume: 1,\r\n  playmode: 'listloop',\r\n  autoplay: false\r\n}\r\n\r\nconst playmodes: { [key: string]: IplaymodeConstructor } = {\r\n  listloop: listloopPlaymode,\r\n  singlecycle: singlecyclePlaymode,\r\n  listrandom: listrandomPlaymode\r\n}\r\n\r\nfunction playlistPreFilter(playlist: Iplaylist) {\r\n  return playlist.map((audio, index) => {\r\n    let res = {\r\n      ...audio\r\n    };\r\n    if (typeof audio.lyric === 'string' && audio.lyric.replace(/\\n+/gi, \"\\n\").trim()) {\r\n      res.lyric = decodeLyricStr(audio.lyric)\r\n    }\r\n    if (typeof audio.sublyric === 'string' && audio.sublyric.replace(/\\n+/gi, \"\\n\").trim()) {\r\n      res.sublyric = decodeLyricStr(audio.sublyric)\r\n    }\r\n    return res;\r\n  })\r\n}\r\n\r\nexport default class cplayer extends EventEmitter {\r\n  private __paused = true;\r\n  public view: View;\r\n  public audioElement: HTMLAudioElement | HTMLVideoElement;\r\n  private playmode: Iplaymode;\r\n  private playmodeName: string = 'listloop';\r\n  private audioElementType: string;\r\n  private _volume: number = 0;\r\n  set mode(playmode: string) {\r\n    this.setMode(playmode);\r\n  }\r\n  set volume(volume: number) {\r\n    this.setVolume(volume);\r\n  }\r\n  get volume() {\r\n    return this._volume\r\n  }\r\n  get mode() {\r\n    return this.playmodeName;\r\n  }\r\n  get playlist() {\r\n    return this.playmode.playlist;\r\n  }\r\n  get nowplay() {\r\n    return this.playmode && this.playmode.now();\r\n  }\r\n  get nowplaypoint() {\r\n    return this.playmode && this.playmode.nowpoint();\r\n  }\r\n  get played() {\r\n    return !this.__paused;\r\n  }\r\n  get paused() {\r\n    return this.__paused;\r\n  }\r\n  get duration() {\r\n    if (this.audioElement) {\r\n      return this.audioElement.duration;\r\n    }\r\n    return 0;\r\n  }\r\n  get currentTime() {\r\n    if (this.audioElement) {\r\n      return this.audioElement.currentTime;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  constructor(options: ICplayerOption & ICplayerViewOption) {\r\n    super();\r\n    options = {\r\n      ...defaultOption,\r\n      ...options\r\n    }\r\n    this.playmode = new playmodes[options.playmode](playlistPreFilter(options.playlist), options.point);\r\n    if (!process.env.cplayer_noview)this.view = new cplayerView(this, options);\r\n    cplayerMediaSessionPlugin(this);\r\n    // 同步调用会导致，用户的事件得不到触发\r\n    setImmediate(() => {\r\n      this.openAudio();\r\n      this.setVolume(options.volume);\r\n      if (options.autoplay && this.playlist.length > 0) {\r\n        this.play(true).catch((e) => {\r\n          console.log(e);\r\n          this.pause();\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  private initializeEventEmitter(element: HTMLElement) {\r\n    const a = element.addEventListener.bind(element);\r\n    const e = this.eventHandlers;\r\n    a('timeupdate', e.handleTimeUpdate);\r\n    a('canplaythrough', e.handleCanPlayThrough);\r\n    a('pause', e.handlePause);\r\n    a('play', e.handlePlay);\r\n    a('playing', e.handlePlaying)\r\n    a('ended', e.handleEnded);\r\n    a('loadeddata', e.handleLoadeddata);\r\n  }\r\n\r\n  private removeEventEmitter(element: HTMLElement) {\r\n    const r = element.removeEventListener.bind(element);\r\n    const e = this.eventHandlers;\r\n    r('timeupdate', e.handleTimeUpdate);\r\n    r('canplaythrough', e.handleCanPlayThrough);\r\n    r('pause', e.handlePause);\r\n    r('play', e.handlePlay);\r\n    r('playing', e.handlePlaying)\r\n    r('ended', e.handleEnded);\r\n    r('loadeddata', e.handleLoadeddata);\r\n  }\r\n\r\n  private eventHandlers: { [key: string]: (...args: any[]) => void } = {\r\n    handlePlay: (...args) => {\r\n      if (this.__paused) {\r\n        this.pause();\r\n      }\r\n    },\r\n    handlePlaying: (...args) => {\r\n      if (this.audioElement.currentTime === 0) {\r\n        this.emit('started');\r\n      }\r\n    },\r\n    handleTimeUpdate: (...args) => {\r\n      let time = this.audioElement.duration;\r\n      let playedTime = this.audioElement.currentTime;\r\n      this.emit('timeupdate', playedTime, time);\r\n    },\r\n    handleCanPlayThrough: (...args) => {\r\n      this.emit('canplaythrough', ...args);\r\n    },\r\n    handlePause: (...args) => {\r\n      if (!this.__paused && !this.audioElement.ended) {\r\n        this.play(true).catch((e) => {\r\n          console.log(e);\r\n          this.pause();\r\n        });\r\n      }\r\n    },\r\n    handleEnded: (...args) => {\r\n      this.emit('ended', ...args);\r\n      if (!this.__paused) {\r\n        this.next();\r\n      }\r\n    },\r\n    handlePlayListChange: (...args) => {\r\n      this.emit('playlistchange', ...args);\r\n    },\r\n    handlePlaymodeChange: (mode: string = this.mode) => {\r\n      this.emit('playmodechange', mode);\r\n    },\r\n    handleLoadeddata: (...args) => {\r\n      let time = this.audioElement.duration;\r\n      let playedTime = this.audioElement.currentTime;\r\n      this.emit('timeupdate', playedTime, time);\r\n    }\r\n  }\r\n\r\n  public setCurrentTime(currentTime: number | string) {\r\n    if (typeof currentTime === 'string') {\r\n      currentTime.trim();\r\n      if (currentTime[currentTime.length - 1] === '%') {\r\n        const percentage = parseFloat(currentTime);\r\n        currentTime = this.duration * (percentage / 100);\r\n      }\r\n    }\r\n    if (this.audioElement) {\r\n      this.audioElement.currentTime = parseFloat(currentTime.toString());\r\n    }\r\n  }\r\n\r\n  private isPlaying() {\r\n    return !!this.audioElement && this.audioElement.currentTime > 0 && !this.audioElement.paused && !this.audioElement.ended && this.audioElement.readyState > 2;\r\n  }\r\n\r\n  public openAudio(audio: IAudioItem = this.nowplay) {\r\n    if (audio) {\r\n      if (audio.type === 'video') {\r\n        if (!(this.audioElementType === 'HTMLVideoElement')) {\r\n          if(typeof this.audioElement !== 'undefined') {\r\n            this.removeEventEmitter(this.audioElement);\r\n            this.audioElement.src = '';\r\n          }\r\n          this.audioElement = document.createElement('video');\r\n          if (this.audioElement instanceof HTMLVideoElement) {\r\n            this.audioElementType = 'HTMLVideoElement';\r\n            this.audioElement.loop = false;\r\n            this.audioElement.autoplay = false;\r\n            this.audioElement.poster = audio.poster;\r\n            this.audioElement.setAttribute('playsinline', 'true');\r\n            this.audioElement.setAttribute('webkit-playsinline', 'true');\r\n          }\r\n          this.initializeEventEmitter(this.audioElement);\r\n          this.emit('audioelementchange', this.audioElement);\r\n        }\r\n      } else { \r\n        if (!(this.audioElementType === 'HTMLAudioElement')) {\r\n          if(typeof this.audioElement !== 'undefined') { \r\n            this.removeEventEmitter(this.audioElement);\r\n            this.audioElement.src = '';\r\n          }\r\n          this.audioElement = new Audio();\r\n          this.audioElementType = 'HTMLAudioElement';\r\n          this.audioElement.loop = false;\r\n          this.audioElement.autoplay = false;\r\n          this.initializeEventEmitter(this.audioElement);\r\n          this.emit('audioelementchange', this.audioElement);\r\n        }\r\n      }\r\n      this.setVolume(this.volume);\r\n      this.audioElement.src = this.nowplay.src;\r\n      this.emit('openaudio', audio);\r\n      if (!this.__paused) {\r\n        this.play();\r\n      }\r\n    }\r\n  }\r\n\r\n  public toggleMode() {\r\n    switch (this.playmodeName) {\r\n      case 'listloop': this.setMode('singlecycle'); break;\r\n      case 'singlecycle': this.setMode('listrandom'); break;\r\n      case 'listrandom': this.setMode('listloop'); break;\r\n    }\r\n  }\r\n\r\n  public setMode(playmode: string) {\r\n    if (typeof playmode === 'string') {\r\n      if (this.playmodeName !== playmode) {\r\n        if (playmodes[playmode]) {\r\n          this.playmode = new playmodes[playmode](this.playlist, this.nowplaypoint);\r\n          this.playmodeName = playmode;\r\n          this.eventHandlers.handlePlaymodeChange();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public getMode() {\r\n    return this.mode;\r\n  }\r\n\r\n  public play(Forced: boolean = false) {\r\n    let isPlaying = this.isPlaying();\r\n    let res;\r\n    if (!isPlaying && this.playlist.length > 0 || Forced) {\r\n      res = this.audioElement.play();\r\n    }\r\n    if (this.__paused) {\r\n      this.__paused = false;\r\n      this.emit('playstatechange', this.__paused);\r\n      this.emit('play');\r\n    }\r\n    return res;\r\n  }\r\n\r\n  public pause(Forced: boolean = false) {\r\n    let isPlaying = this.isPlaying();\r\n    if (isPlaying && this.playlist.length > 0 || Forced) {\r\n      this.audioElement.pause();\r\n    }\r\n    if (!this.__paused) {\r\n      this.__paused = true;\r\n      this.emit('playstatechange', this.__paused);\r\n      this.emit('pause');\r\n    }\r\n  }\r\n\r\n  public to(id: number) {\r\n    this.playmode.to(id);\r\n    this.openAudio();\r\n  }\r\n\r\n  public next() {\r\n    this.playmode.next();\r\n    this.openAudio();\r\n  }\r\n\r\n  public prev() {\r\n    this.playmode.prev();\r\n    this.openAudio();\r\n  }\r\n\r\n  public togglePlayState() {\r\n    if (this.__paused) {\r\n      this.play();\r\n    } else {\r\n      this.pause();\r\n    }\r\n  }\r\n\r\n  public add(item: IAudioItem) {\r\n    item = (playlistPreFilter([item] as Iplaylist))[0];\r\n    this.playmode.addMusic(item);\r\n    this.eventHandlers.handlePlayListChange();\r\n    if (this.playlist.length === 1) {\r\n      this.to(0);\r\n    }\r\n  }\r\n\r\n  public remove(item: IAudioItem) {\r\n    let needUpdate = this.playmode.removeMusic(item);\r\n    this.eventHandlers.handlePlayListChange();\r\n    if (needUpdate) {\r\n      this.openAudio();\r\n    }\r\n  }\r\n\r\n  public setVolume(volume: number | string) {\r\n    this._volume = parseFloat(volume as string);\r\n    if (this.audioElement)\r\n      this.audioElement.volume = Math.max(0.0, Math.min(1.0, this._volume));\r\n    this.emit('volumechange', this.volume);\r\n  }\r\n\r\n  public destroy() {\r\n    if (this.audioElement) {\r\n      this.audioElement.src = null;\r\n      this.audioElement.removeEventListener(\"timeupdate\", this.eventHandlers.handleTimeUpdate);\r\n      this.removeAllListeners();  \r\n    }\r\n    if (this.view) this.view.destroy();\r\n    Object.getOwnPropertyNames(this).forEach((name: keyof cplayer) => delete this[name]);\r\n    (this as any).__proto__ = Object;\r\n  }\r\n}\r\n\r\nif (!process.env.cplayer_noview) {\r\n  function parseCPlayerTag() {\r\n    Array.prototype.forEach.call(document.querySelectorAll('template[cplayer]'),(element: Element) => {\r\n      element.attributes.getNamedItem('loaded') ||\r\n        new cplayer({\r\n          generateBeforeElement: true,\r\n          deleteElementAfterGenerate: true,\r\n          element,\r\n          ...JSON.parse(element.innerHTML)\r\n        })\r\n    })\r\n  }\r\n\r\n  window.addEventListener(\"load\", parseCPlayerTag);\r\n}\r\n\r\n(window as any).cplayer = cplayer;","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","if (typeof Object.assign != 'function') {\r\n    // Must be writable: true, enumerable: false, configurable: true\r\n    Object.defineProperty(Object, \"assign\", {\r\n        value: function assign(target, varArgs) { // .length of function is 2\r\n            'use strict';\r\n            if (target == null) { // TypeError if undefined or null\r\n                throw new TypeError('Cannot convert undefined or null to object');\r\n            }\r\n\r\n            var to = Object(target);\r\n\r\n            for (var index = 1; index < arguments.length; index++) {\r\n                var nextSource = arguments[index];\r\n\r\n                if (nextSource != null) { // Skip over if undefined or null\r\n                    for (var nextKey in nextSource) {\r\n                        // Avoid bugs when hasOwnProperty is shadowed\r\n                        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n                            to[nextKey] = nextSource[nextKey];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return to;\r\n        },\r\n        writable: true,\r\n        configurable: true\r\n    });\r\n}","const hasOwn = Object.prototype.hasOwnProperty\r\n\r\nfunction is(x: any, y: any) {\r\n  if (x == y) {\r\n    return x != 0 || y != 0 || 1 / x == 1 / y\r\n  } else {\r\n    return x != x && y != y\r\n  }\r\n}\r\n\r\nexport default function shallowEqual(objA: any, objB: any) {\r\n  if (is(objA, objB)) return true\r\n\r\n  if (typeof objA !== 'object' || objA === null ||\r\n      typeof objB !== 'object' || objB === null) {\r\n    return false\r\n  }\r\n\r\n  const keysA = Object.keys(objA)\r\n  const keysB = Object.keys(objB)\r\n\r\n  if (keysA.length !== keysB.length) return false\r\n\r\n  for (let i = 0; i < keysA.length; i++) {\r\n    if (!hasOwn.call(objB, keysA[i]) ||\r\n        !is(objA[keysA[i]], objB[keysA[i]])) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","export interface ILyricItem {\r\n  time: number;\r\n  word: string;\r\n}\r\n\r\n\r\nexport class Lyric {\r\n  raw: string;\r\n  items: ILyricItem[] = [];\r\n  public getLyric(time: number) {\r\n    return this.items.reduce((p, c) => {\r\n      if (c.time < time && (!p || p.time < c.time)) {\r\n        return c;\r\n      }\r\n      return p;\r\n    }, undefined)\r\n  }\r\n  public getNextLyric(time: number) {\r\n    return this.items.reduce((p, c) => {\r\n      if (c.time > time && (!p || p.time > c.time)) {\r\n        return c;\r\n      }\r\n      return p;\r\n    }, undefined)\r\n  }\r\n  public toString() {\r\n    return this.raw;\r\n  }\r\n  constructor(items: ILyricItem[] ,raw: string) {\r\n    this.items = items;\r\n    this.raw = raw;\r\n  }\r\n}\r\n\r\nexport function decodeLyricStr(lyricStr: string, options?: {}) {\r\n  if (typeof lyricStr !== 'string') return lyricStr;\r\n  let lyric: ILyricItem[] = [];\r\n  lyricStr.replace(/\\n+/gi, \"\\n\").trim().split(\"\\n\").forEach((lyricStrItem) => {\r\n    lyric.push(...decodeLyricStrItem(lyricStrItem));\r\n  });\r\n  if (lyric.length == 0) return undefined;\r\n  return new Lyric(lyric, lyricStr);\r\n}\r\n\r\nexport function decodeLyricStrItem(lyricItemStr: string): ILyricItem[] {\r\n  let res: ILyricItem[] = [];\r\n  let timestr = lyricItemStr.match(/\\[\\d+\\:[\\.\\d]+\\]/gi);\r\n  let word = /(?:\\[\\d+\\:[\\.\\d]+\\])*(.*)/gi.exec(lyricItemStr)[1].trim()\r\n  if (timestr && word) {\r\n    timestr.forEach((timestr) => {\r\n      let z = /\\[(\\d+)\\:([\\.\\d]+)\\]/gi.exec(timestr.trim());\r\n      let time = parseInt(z[1]) * 60 * 1000 + parseFloat(z[2]) * 1000;\r\n      res.push({\r\n        time,\r\n        word\r\n      });\r\n    })\r\n  }\r\n  return res;\r\n}","import { IAudioItem, Iplaymode, Iplaylist } from '../interfaces';\r\nimport shallowEqual from \"../helper/shallowEqual\";\r\nimport { baseRemoveMusic } from \"./listloop\";\r\n\r\nexport class singlecyclePlaymode implements Iplaymode {\r\n  private __playlist: Iplaylist = [];\r\n  private audio: IAudioItem;\r\n  private point: number;\r\n  get playlist() {\r\n    return this.__playlist;\r\n  }\r\n\r\n  constructor(playlist: Iplaylist = [], point: number = 0) {\r\n    this.__playlist = playlist;\r\n    this.to(point);\r\n  }\r\n\r\n  public next() {\r\n    return this.__playlist[this.point];\r\n  }\r\n\r\n  public prev() {\r\n    return this.__playlist[this.point];\r\n  }\r\n\r\n  public now() {\r\n    return this.__playlist[this.point];\r\n  }\r\n\r\n  public nowpoint() {\r\n    return this.point;\r\n  }\r\n\r\n  public to(point: number) {\r\n    this.point = Math.max(0, Math.min(point, this.__playlist.length - 1));\r\n  }\r\n\r\n  public addMusic(item: IAudioItem) {\r\n    this.__playlist.push(item);\r\n  }\r\n\r\n  public removeMusic(item: IAudioItem) {\r\n    let {playlist,nowpoint,needupdate} = baseRemoveMusic(item, this.__playlist, this.point, (point) => Math.max(0, Math.min(point, this.__playlist.length - 1)))\r\n    this.__playlist = playlist;\r\n    this.point = nowpoint;\r\n    return needupdate;\r\n  }\r\n}","import { IAudioItem, Iplaymode, Iplaylist } from '../interfaces';\r\nimport shallowEqual from \"../helper/shallowEqual\";\r\nimport { baseRemoveMusic } from \"./listloop\";\r\n\r\nexport class listrandomPlaymode implements Iplaymode {\r\n  private __playlist: Iplaylist = [];\r\n  private point = 0;\r\n  get playlist() {\r\n    return this.__playlist;\r\n  }\r\n\r\n  constructor(playlist: Iplaylist = [], point: number = 0) {\r\n    this.__playlist = playlist;\r\n    this.to(point);\r\n  }\r\n\r\n  public next() {\r\n    this.point = this.randomPoint();\r\n    return this.__playlist[this.point];\r\n  }\r\n\r\n  public prev() {\r\n    this.point = this.randomPoint();\r\n    return this.__playlist[this.point];\r\n  }\r\n\r\n  public now() {\r\n    return this.__playlist[this.point];\r\n  }\r\n\r\n  public nowpoint() {\r\n    return this.point;\r\n  }\r\n\r\n  public to(point: number) {\r\n    this.point = Math.max(0, Math.min(point, this.__playlist.length - 1));\r\n  }\r\n\r\n  public addMusic(item:IAudioItem){\r\n    this.__playlist.push(item);\r\n  }\r\n\r\n  private randomPoint(): number {\r\n    if (this.__playlist.length > 1) {\r\n      let random = Math.floor(this.__playlist.length * Math.random());\r\n      if (random === this.point) {\r\n        return this.randomPoint();\r\n      } else {\r\n        return random;\r\n      }\r\n    } else return 0;\r\n  }\r\n\r\n  public removeMusic(item: IAudioItem) {\r\n    let {playlist,nowpoint,needupdate} = baseRemoveMusic(item, this.__playlist, this.point, (point) => this.randomPoint())\r\n    this.__playlist = playlist;\r\n    this.point = nowpoint;\r\n    return needupdate;\r\n  }\r\n}","import cplayer from './';\r\nimport { IAudioItem } from '../lib/interfaces';\r\n\r\nconst defaultPoster = require('../defaultposter.jpg')\r\n\r\nexport function cplayerMediaSessionPlugin(player: cplayer)\r\n{\r\n  if ('mediaSession' in navigator) {\r\n    if (player.nowplay) navigator.mediaSession.metadata = mediaMetadata(player.nowplay);\r\n    navigator.mediaSession.setActionHandler('play', () => player.play());\r\n    navigator.mediaSession.setActionHandler('pause', () => player.pause());\r\n    navigator.mediaSession.setActionHandler('previoustrack', () => player.prev());\r\n    navigator.mediaSession.setActionHandler('nexttrack', () => player.next());\r\n    player.on('openaudio', () => {\r\n      navigator.mediaSession.metadata = mediaMetadata(player.nowplay);\r\n    })\r\n  }\r\n}\r\n\r\nexport function mediaMetadata(audio: IAudioItem) {\r\n  return new MediaMetadata({\r\n    title: audio.name,\r\n    artist: audio.artist,\r\n    album: audio.album,\r\n    artwork: [\r\n      {\r\n        sizes: '720x720',\r\n        src: audio.poster || defaultPoster\r\n      }\r\n    ]\r\n  });\r\n}\r\n","module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAAiACIDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAcDBAUG/8QALhAAAgEDAwIFAwMFAAAAAAAAAQIDAAQRBRIhE0EGIjFRkRQzYTI1cXOBocHR/8QAGAEAAwEBAAAAAAAAAAAAAAAAAQIDBAX/xAAiEQACAQMCBwAAAAAAAAAAAAAAAQIDETESFAQhIkFRYWL/2gAMAwEAAhEDEQA/AGBo7mOKMEBjgc4rqLaRWXG1fgUttA1qNbnpPdGV5mIRRhkiKgeTjkE5J5/1W9pniH6jVbuPdiO2gJwHG13B5wcc44+a5tPpNM4N3OwlC45RfgVlXMA2t5E/nFVZ/EEaWVlcmJmjuDHnDAdIP6MR3GSBx71Fe37LbSSKylVIyNwyM002IotGc2N7cr6+1FYTXu5iepKcnP66KzF9AoBfQ2LmzgWWJp3L72A8rNt2kY5x/wBrtfD+oSXkQ6k8iQSRuJVjwr78DcATx6YyfYehNcbsttTkayGoiGcPuh3REo2FG0bt2R6e3fvVW2vulYSSMPND9vk46jcA/Ab/ABXTlBSXsCnpvfAydb8TR3eg7bMrGrStB1c8r0wTsP4PDKe/OeRUXiPxFLBojump6fFcTtGFeCTDHaoJyMe5A70uYte+n097Z7eK6EjA4mJCptXAK7SOcE1S1a9jvbqNoYzFCkSIiFtxGBzk9znvQXD81cV1kkMSAWDQRt9bMuVB272OOPTOKKVu4+5+aKO2+gbleC5bfusf9U1ctlB1RYiAYy/Kn0P9qKKtLIkMGfeKBdkAADjgVFcffYdgcD8UUU6JPuR0UUURT//Z\""],"sourceRoot":""}